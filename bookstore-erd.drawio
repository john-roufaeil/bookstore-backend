<mxfile host="Electron" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.2.5 Chrome/138.0.7204.251 Electron/37.6.1 Safari/537.36" version="28.2.5">
  <diagram id="bserd" name="Bookstore ERD + API">
    <mxGraphModel dx="3834" dy="1295" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1654" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="&lt;font style=&quot;font-size: 46px;&quot;&gt;Online Bookstore — ERD + API Endpoints&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=22;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="80" y="150" width="1000" height="44" as="geometry" />
        </mxCell>
        <mxCell id="leg" value="API Color Key" style="swimlane;startSize=26;fillColor=#f5f5f5;strokeColor=#999999;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="1040" y="350" width="240" height="158" as="geometry" />
        </mxCell>
        <mxCell id="leg1" value="POST = Create" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=13;fontColor=#166534;" parent="leg" vertex="1">
          <mxGeometry y="26" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="leg2" value="GET = Read" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=13;fontColor=#1d4ed8;" parent="leg" vertex="1">
          <mxGeometry y="52" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="leg3" value="PUT / PATCH = Update" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=13;fontColor=#92400e;" parent="leg" vertex="1">
          <mxGeometry y="78" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="leg4" value="DELETE = Remove" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=13;fontColor=#991b1b;" parent="leg" vertex="1">
          <mxGeometry y="104" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="leg5" value="[Admin] = Admin role required" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#555555;" parent="leg" vertex="1">
          <mxGeometry y="130" width="240" height="22" as="geometry" />
        </mxCell>
        <mxCell id="user" value="USER" style="swimlane;fontStyle=1;align=center;startSize=26;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="-210" y="260" width="290" height="380" as="geometry" />
        </mxCell>
        <mxCell id="uf_hdr" value="FIELDS" style="text;html=1;strokeColor=#c9e0f5;fillColor=#e4f0fc;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="user" vertex="1">
          <mxGeometry y="26" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="uf1" value="_id : ObjectId (PK)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="user" vertex="1">
          <mxGeometry y="46" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="uf2" value="email : String  [unique, indexed]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="user" vertex="1">
          <mxGeometry y="70" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="uf3" value="firstName : String" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="user" vertex="1">
          <mxGeometry y="94" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="uf4" value="lastName : String" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="user" vertex="1">
          <mxGeometry y="118" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="uf5" value="dob : Date" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="user" vertex="1">
          <mxGeometry y="142" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="uf6" value="password : String (bcrypt, never returned)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="user" vertex="1">
          <mxGeometry y="166" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="uf7" value="role : &#39;user&#39; | &#39;admin&#39;  (default: &#39;user&#39;)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="user" vertex="1">
          <mxGeometry y="190" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="uf8" value="isVerified : Boolean  (default: false)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="user" vertex="1">
          <mxGeometry y="214" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ua_hdr" value="API ENDPOINTS" style="text;html=1;strokeColor=#c9e0f5;fillColor=#e4f0fc;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="user" vertex="1">
          <mxGeometry y="238" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ua1" value="POST /api/auth/register" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#166534;" parent="user" vertex="1">
          <mxGeometry y="258" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ua2" value="POST /api/auth/login" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#166534;" parent="user" vertex="1">
          <mxGeometry y="282" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ua3" value="POST /api/auth/logout" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#166534;" parent="user" vertex="1">
          <mxGeometry y="306" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ua4" value="PUT /api/users/profile" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#92400e;" parent="user" vertex="1">
          <mxGeometry y="330" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ua5" value="GET /api/auth/verify/:token  (bonus)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="user" vertex="1">
          <mxGeometry y="354" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="book" value="BOOK" style="swimlane;fontStyle=1;align=center;startSize=26;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="580" y="988" width="290" height="406" as="geometry" />
        </mxCell>
        <mxCell id="bf_hdr" value="FIELDS" style="text;html=1;strokeColor=#b7d9b5;fillColor=#e6f4e4;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="book" vertex="1">
          <mxGeometry y="26" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="bf1" value="_id : ObjectId (PK)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="book" vertex="1">
          <mxGeometry y="46" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="bf2" value="name : String  [text indexed for search]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="book" vertex="1">
          <mxGeometry y="70" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="bf3" value="price : Number  [positive, indexed]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="book" vertex="1">
          <mxGeometry y="94" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="bf4" value="stock : Integer  [&gt;= 0]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="book" vertex="1">
          <mxGeometry y="118" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="bf5" value="coverImage : Cloudinary URL" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="book" vertex="1">
          <mxGeometry y="142" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="bf6" value="author : FK → Author" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="book" vertex="1">
          <mxGeometry y="166" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="bf7" value="category : FK → Category  (nullable)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="book" vertex="1">
          <mxGeometry y="190" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="bf8" value="createdAt : Date" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="book" vertex="1">
          <mxGeometry y="214" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ba_hdr" value="API ENDPOINTS" style="text;html=1;strokeColor=#b7d9b5;fillColor=#e6f4e4;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="book" vertex="1">
          <mxGeometry y="238" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ba1" value="POST /api/books  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#166534;" parent="book" vertex="1">
          <mxGeometry y="258" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ba2" value="GET /api/books  [filter, search, page]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="book" vertex="1">
          <mxGeometry y="282" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ba3" value="GET /api/books/:id" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="book" vertex="1">
          <mxGeometry y="306" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ba4" value="PUT /api/books/:id  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#92400e;" parent="book" vertex="1">
          <mxGeometry y="330" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ba5" value="DELETE /api/books/:id  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#991b1b;" parent="book" vertex="1">
          <mxGeometry y="354" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ba6" value="POST /api/upload/presign  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#166534;" parent="book" vertex="1">
          <mxGeometry y="378" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="author" value="AUTHOR" style="swimlane;fontStyle=1;align=center;startSize=26;fillColor=#ffe6cc;strokeColor=#d6b656;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="1040" y="750" width="290" height="218" as="geometry" />
        </mxCell>
        <mxCell id="atf_hdr" value="FIELDS" style="text;html=1;strokeColor=#f0d8b0;fillColor=#fff3e0;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="author" vertex="1">
          <mxGeometry y="26" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="atf1" value="_id : ObjectId (PK)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="author" vertex="1">
          <mxGeometry y="46" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="atf2" value="name : String" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="author" vertex="1">
          <mxGeometry y="70" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="atf3" value="bio : String" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="author" vertex="1">
          <mxGeometry y="94" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ata_hdr" value="API ENDPOINTS" style="text;html=1;strokeColor=#f0d8b0;fillColor=#fff3e0;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="author" vertex="1">
          <mxGeometry y="118" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ata1" value="POST /api/authors  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#166534;" parent="author" vertex="1">
          <mxGeometry y="138" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ata2" value="GET /api/authors" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="author" vertex="1">
          <mxGeometry y="162" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ata3" value="PUT /api/authors/:id  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#92400e;" parent="author" vertex="1">
          <mxGeometry y="186" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="cat" value="CATEGORY" style="swimlane;fontStyle=1;align=center;startSize=26;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="1040" y="1080" width="290" height="218" as="geometry" />
        </mxCell>
        <mxCell id="cf_hdr" value="FIELDS" style="text;html=1;strokeColor=#cfc0d8;fillColor=#ede6f2;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="cat" vertex="1">
          <mxGeometry y="26" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="cf1" value="_id : ObjectId (PK)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="cat" vertex="1">
          <mxGeometry y="46" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="cf2" value="name : String  [unique]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="cat" vertex="1">
          <mxGeometry y="70" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ca_hdr" value="API ENDPOINTS" style="text;html=1;strokeColor=#cfc0d8;fillColor=#ede6f2;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="cat" vertex="1">
          <mxGeometry y="94" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ca1" value="POST /api/categories  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#166534;" parent="cat" vertex="1">
          <mxGeometry y="114" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ca2" value="GET /api/categories" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="cat" vertex="1">
          <mxGeometry y="138" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ca3" value="PUT /api/categories/:id  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#92400e;" parent="cat" vertex="1">
          <mxGeometry y="162" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ca4" value="DELETE /api/categories/:id  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#991b1b;" parent="cat" vertex="1">
          <mxGeometry y="186" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="cart" value="CART" style="swimlane;fontStyle=1;align=center;startSize=26;fillColor=#d4edda;strokeColor=#5ba08a;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="160" y="590" width="290" height="218" as="geometry" />
        </mxCell>
        <mxCell id="ctf_hdr" value="FIELDS" style="text;html=1;strokeColor=#b8dfc8;fillColor=#e6f5ec;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="cart" vertex="1">
          <mxGeometry y="26" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ctf1" value="_id : ObjectId (PK)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="cart" vertex="1">
          <mxGeometry y="46" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ctf2" value="user : FK → User  [unique — 1 cart per user]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="cart" vertex="1">
          <mxGeometry y="70" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ctf3" value="items : [{ book: FK, quantity: Int }]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="cart" vertex="1">
          <mxGeometry y="94" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="cta_hdr" value="API ENDPOINTS  (JWT required)" style="text;html=1;strokeColor=#b8dfc8;fillColor=#e6f5ec;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="cart" vertex="1">
          <mxGeometry y="118" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="cta1" value="POST /api/cart  (add book)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#166534;" parent="cart" vertex="1">
          <mxGeometry y="138" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="cta2" value="GET /api/cart" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="cart" vertex="1">
          <mxGeometry y="162" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="cta3" value="DELETE /api/cart/:bookId" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#991b1b;" parent="cart" vertex="1">
          <mxGeometry y="186" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="order" value="ORDER" style="swimlane;fontStyle=1;align=center;startSize=26;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="-150" y="1010" width="290" height="362" as="geometry" />
        </mxCell>
        <mxCell id="of_hdr" value="FIELDS" style="text;html=1;strokeColor=#f0b8b5;fillColor=#fce8e7;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="order" vertex="1">
          <mxGeometry y="26" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="of1" value="_id : ObjectId (PK)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="order" vertex="1">
          <mxGeometry y="46" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="of2" value="user : FK → User" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="order" vertex="1">
          <mxGeometry y="70" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="of3" value="items : [{ book:FK, qty, priceAtPurchase }]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="order" vertex="1">
          <mxGeometry y="94" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="of4" value="shippingDetails : { name, addr, city, phone }" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="order" vertex="1">
          <mxGeometry y="118" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="of5" value="status : processing | out_for_delivery | delivered" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=11;" parent="order" vertex="1">
          <mxGeometry y="142" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="of6" value="paymentMethod : &#39;COD&#39;  (default)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="order" vertex="1">
          <mxGeometry y="166" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="of7" value="paymentStatus : pending | success" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="order" vertex="1">
          <mxGeometry y="190" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="of8" value="createdAt : Date" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="order" vertex="1">
          <mxGeometry y="214" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="oa_hdr" value="API ENDPOINTS  (MongoDB transaction on POST)" style="text;html=1;strokeColor=#f0b8b5;fillColor=#fce8e7;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="order" vertex="1">
          <mxGeometry y="238" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oa1" value="POST /api/orders" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#166534;" parent="order" vertex="1">
          <mxGeometry y="258" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="oa2" value="GET /api/orders/my" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="order" vertex="1">
          <mxGeometry y="282" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="oa3" value="GET /api/orders  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="order" vertex="1">
          <mxGeometry y="306" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="oa4" value="PATCH /api/orders/:id/status  [Admin]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#92400e;" parent="order" vertex="1">
          <mxGeometry y="330" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="review" value="REVIEW" style="swimlane;fontStyle=1;align=center;startSize=26;fillColor=#f3d9fa;strokeColor=#cc77cc;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="520" y="280" width="290" height="314" as="geometry" />
        </mxCell>
        <mxCell id="rf_hdr" value="FIELDS" style="text;html=1;strokeColor=#e8bef0;fillColor=#f9edfb;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="review" vertex="1">
          <mxGeometry y="26" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rf1" value="_id : ObjectId (PK)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="review" vertex="1">
          <mxGeometry y="46" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="rf2" value="user : FK → User" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="review" vertex="1">
          <mxGeometry y="70" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="rf3" value="book : FK → Book" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="review" vertex="1">
          <mxGeometry y="94" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="rf4" value="rating : Number  [1 - 5]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="review" vertex="1">
          <mxGeometry y="118" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="rf5" value="comment : String  [optional, max 500 chars]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="review" vertex="1">
          <mxGeometry y="142" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="rf6" value="createdAt : Date" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;" parent="review" vertex="1">
          <mxGeometry y="166" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="rf7" value="* compound unique index on (user, book)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=11;fontColor=#6d28d9;fontStyle=2;" parent="review" vertex="1">
          <mxGeometry y="190" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ra_hdr" value="API ENDPOINTS  (only if order = delivered)" style="text;html=1;strokeColor=#e8bef0;fillColor=#f9edfb;align=left;verticalAlign=middle;spacingLeft=6;fontStyle=1;fontSize=11;" parent="review" vertex="1">
          <mxGeometry y="214" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ra1" value="POST /api/reviews" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#166534;" parent="review" vertex="1">
          <mxGeometry y="234" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ra2" value="GET /api/reviews/:bookId" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#1d4ed8;" parent="review" vertex="1">
          <mxGeometry y="258" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ra3" value="DELETE /api/reviews/:id  (owner or Admin)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=8;fontSize=12;fontColor=#991b1b;" parent="review" vertex="1">
          <mxGeometry y="282" width="290" height="24" as="geometry" />
        </mxCell>
        <mxCell id="rel_auth_book" value="1 : N" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=ERmany;endFill=0;startArrow=ERmandOne;startFill=0;strokeColor=#d6b656;strokeWidth=2;fontStyle=1;fontSize=11;" parent="1" source="author" target="book" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="820" y="859" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel_cat_book" value="1 : N (nullable)" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=ERmany;endFill=0;startArrow=ERone;startFill=0;dashed=1;strokeColor=#9673a6;strokeWidth=2;fontStyle=1;fontSize=11;" parent="1" source="cat" target="book" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel_user_cart" value="1 : 1" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=ERmandOne;endFill=0;startArrow=ERmandOne;startFill=0;strokeColor=#6c8ebf;strokeWidth=2;fontStyle=1;fontSize=11;" parent="1" source="user" target="cart" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel_user_order" value="1 : N" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=ERmany;endFill=0;startArrow=ERmandOne;startFill=0;strokeColor=#6c8ebf;strokeWidth=2;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontStyle=1;fontSize=11;" parent="1" source="user" target="order" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-210" y="440" />
              <mxPoint x="-280" y="440" />
              <mxPoint x="-280" y="1191" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel_user_review" value="1 : N" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=ERmany;endFill=0;startArrow=ERmandOne;startFill=0;strokeColor=#6c8ebf;strokeWidth=2;fontStyle=1;fontSize=11;" parent="1" source="user" target="review" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="100" y="430" />
              <mxPoint x="100" y="430" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel_book_review" value="1 : N" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=ERmany;endFill=0;startArrow=ERmandOne;startFill=0;strokeColor=#82b366;strokeWidth=2;fontStyle=1;fontSize=11;" parent="1" source="book" target="review" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="720" y="300" />
              <mxPoint x="720" y="300" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel_cart_book" value="refs (items)" style="edgeStyle=orthogonalEdgeStyle;html=1;dashed=1;dashPattern=8 4;endArrow=open;endFill=0;strokeColor=#5ba08a;strokeWidth=1.5;fontStyle=2;fontSize=11;" parent="1" source="cart" target="book" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="350" y="950" />
              <mxPoint x="670" y="950" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel_order_book" value="refs (items)" style="edgeStyle=orthogonalEdgeStyle;html=1;dashed=1;dashPattern=8 4;endArrow=open;endFill=0;strokeColor=#b85450;strokeWidth=1.5;fontStyle=2;fontSize=11;" parent="1" source="order" target="book" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
